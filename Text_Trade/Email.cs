//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a tool
//     Changes to this file will be lost if the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------

// Eric TODO

using System;
using System.Net;
using System.Net.Mail;


public class Email
{

    public MailAddress e_Mail;

    private string client;
    private string username;
    private string password;
    private int port;
    private bool TSL_SSL;
    private bool defaultsettings;

    public MailAddress E_Mail
    {
        
        get { return this.e_Mail; }

        set { this.e_Mail = value; }
        
    }

    public string UserName
    {

        get { return this.username; }

        set { this.username = value; }

    }

    public string Password
    {

        private get { return this.password; }

        set { this.password = value; }

    }

    // Constructor
    public Email(string email)
    {

        this.e_Mail = new MailAddress(email);

    }

    public Email(string email, bool outlook = false)
    {

        this.e_Mail = new MailAddress(email);

        if (outlook == true)
        {

            client = "smtp.office365.com";
            port = 587;
            TSL_SSL = true;
            defaultsettings = false;

        }

        else
        {

            client = "smtp.gmail.com";
            port = 587;
            TSL_SSL = true;
            defaultsettings = false;

        }

    }

    public void SendMessage(string to, string subject, string body)
    {

        MailMessage mail = new MailMessage();
        mail.From = E_Mail;

        SmtpClient smtp = new SmtpClient();
        smtp.Port = port;
        smtp.EnableSsl = TSL_SSL;
        smtp.DeliveryMethod = SmtpDeliveryMethod.Network;
        smtp.UseDefaultCredentials = defaultsettings;
        smtp.Credentials = new NetworkCredential(mail.From.Address, Password);
        smtp.Host = client;

        mail.To.Add(new MailAddress(to));

        mail.IsBodyHtml = true;

        mail.Body = body;
        smtp.Send(mail);

    }

    public void OpenMessage()
	{
		throw new System.NotImplementedException();
	}

	public virtual void SendMail(Email email)
	{
		throw new System.NotImplementedException();
	}

}

